"use strict";angular.module("angular-dropdownsearch",[]).directive("ilnDropDownSearch",["$document","$rootScope","$timeout",function(e,t,r){return{restrict:"E",scope:{results:"=",title:"=",formval:"="},link:function(t,i){var l=!1,u=0;t.title,t.formval,t.isPopupVisible=!1,t.activeclass="disabled",t.searchText="",t.currentSelected=null,t.$watch("results",function(){t.results?(l=!0,t.activeclass=""):(l=!1,t.activeclass="disabled")}),t.hoverItem=function(e){u=Number(e+1),t.currentSelected=Number(e)},t.isActiveItem=function(e){return String(e)===String(t.currentSelected)?"result-list-item-active":""},t.selectItem=function(e){t.currentSelected=e-1,t.$apply()},t.updateInput=function(){var e=angular.element(i[0].querySelector(".result-list-item-active"))[0];t.title=String(e.attributes["data-dropdown-result"].value),t.formval=String(e.attributes["data-dropdown-result-slug"].value),t.$apply()},t.toggleSelect=function(){return l?(u=0,t.currentSelected=null,t.isPopupVisible=!t.isPopupVisible,void(t.isPopupVisible&&r(function(){i.find("input")[0].focus()}))):!1},e.bind("keydown",function(e){if(!l||!t.isPopupVisible)return!1;var r=0;switch(i[0].querySelector(".result-list-item")&&(r=angular.element(i[0].querySelector(".result-list-item"))[0].attributes["data-length"].value),e.which){case 38:e.preventDefault(),u--,0>=u&&(u=r),t.selectItem(u);break;case 40:e.preventDefault(),u++,u>r&&(u=1),t.selectItem(u);break;case 13:e.preventDefault(),t.updateInput(),t.$apply(function(){t.isPopupVisible=!1});break;default:return}}),e.bind("click",function(e){if(!l)return!1;var r=i[0].contains(e.target);return r?void(e.target.attributes["data-dropdown-result"]&&t.$apply(function(){t.title=String(e.target.attributes["data-dropdown-result"].value),t.formval=String(e.target.attributes["data-dropdown-result-slug"].value),t.isPopupVisible=!1})):void t.$apply(function(){t.isPopupVisible=!1})})},templateUrl:"modules/search-dropdown/client/views/search-dropdown.html"}}]);